# 规划蓝图：将AI助手指令集从Markdown转换为JSON格式
*   **状态**: [规划中]

## 1. 核心目标与验收标准 (Core Objective & Acceptance Criteria)

### a. 核心目标 (Core Objective)
*   将 `AI_PROGRAMMING_ASSISTANT_INSTRUCTIONS.md` 的内容，完整、准确地转换为一个结构化的JSON文件 `PROMPT_MEMORY.json`，以便于程序化解析和使用。

### b. 验收标准 (Acceptance Criteria)
*   `[ ]` 成功在项目根目录创建新文件 `PROMPT_MEMORY.json`。
*   `[ ]` `PROMPT_MEMORY.json` 必须是语法完全正确的JSON格式。
*   `[ ]` JSON文件的结构必须清晰地反映原始Markdown文档的层级关系（章节 -> 子章节 -> 原则 -> 具体规则）。
*   `[ ]` 原始Markdown中的所有文本内容（包括标题、正文、列表、代码块）都必须无遗漏地迁移到JSON文件中。
*   `[ ]` JSON文件中的字符串值应保留原始的Markdown格式（例如，`**`加粗，` `` `代码标记）。

## 2. 现状分析与复用性尽职调查 (Current State Analysis & Reuse Due Diligence)

*   **`a. 复用性尽职调查`**:
    *   **搜索关键词**: `JSON`, `converter`, `parser`
    *   **搜索范围**: 项目全局
    *   **发现与结论**: 项目中不存在现成的Markdown到JSON的转换脚本或工具。这是一个全新的文件创建任务。
*   **`b. 潜在影响分析`**:
    *   这是一个纯粹的创建任务，不会修改任何现有文件，因此对现有项目没有直接影响。
    *   新创建的 `PROMPT_MEMORY.json` 文件可能会很大，需要注意处理过程中的内存和工具限制。

## 3. 技术方案与架构设计 (Technical Approach & Architecture Design)

*   **JSON结构设计**:
    *   根节点是一个对象，包含 `version` 和 `instructions` 两个键。
    *   `instructions` 的值是一个数组，每个元素代表一个主章节（例如，"1. 角色与核心使命"）。
    *   每个章节对象包含 `id`, `title`, 和 `content` (可选) 以及一个 `sections` 或 `principles` 数组。
    *   使用嵌套结构来表示规则、子规则、强制行动、禁令等。键名将使用英文以保证JSON的规范性，例如 `title`, `description`, `rules`, `guideline`, `core_tenet`, `mandatory_actions`, `absolute_prohibitions`。
*   **实施策略**:
    *   遵循 **`5. 分段文件创建与错误恢复协议`**。
    *   **第一步 (骨架创建)**: 创建 `PROMPT_MEMORY.json` 文件，并写入最外层的JSON结构 `{"version": "5.2", "instructions": []}`。
    *   **第二步 (逐段填充)**: 逐个解析Markdown文件中的 `####` 章节，将其转换为JSON对象，然后使用 `edit_file` 工具将生成的JSON对象逐个添加到 `instructions` 数组中。这将把一次大的写入操作分解为大约15次小的、独立的操作，大大降低失败风险。

## 4. 任务分解与上下文锚点 (Task Breakdown & Context Anchors)

*   `[ ]` **里程碑1: 文件初始化**
    *   `[ ]` 1.1: 创建 `PROMPT_MEMORY.json` 并写入JSON骨架。
    *   `[ ]` 1.2: **(验证点)** 读取文件，确认骨架写入成功。
*   `[ ]` **里程碑2: 内容转换与填充 (分段执行)**
    *   `[ ]` 2.1: 转换章节 "1. 角色与核心使命" 并写入文件。
    *   `[ ]` 2.2: 转换章节 "2. 最高指令..." 并写入文件。
    *   `[ ]` 2.3: 转换章节 "3. '失忆症免疫'协议" 并写入文件。
    *   `[ ]` 2.4: 转换章节 "4. 调试哲学..." 并写入文件。
    *   `[ ]` 2.5: 转换章节 "5. 分段文件创建..." 并写入文件。
    *   `[ ]` 2.6: 转换章节 "6. 核心工作流程..." 并写入文件。
    *   `[ ]` 2.7: 转换章节 "7. 代码质量..." 并写入文件。
    *   `[ ]` 2.8: 转换章节 "8. 故障案例复盘..." 并写入文件。
    *   `[ ]` 2.9: 转换章节 "9. 组件库使用铁律" 并写入文件。
    *   `[ ]` 2.10: 转换章节 "10. 命令行工具使用铁律" 并写入文件。
    *   `[ ]` 2.11: 转换章节 "11. 单元测试铁律" 并写入文件。
    *   `[ ]` 2.12: 转换章节 "12. 交互与行为准则" 并写入文件。
    *   `[ ]` 2.13: 转换章节 "13. 任务完成报告规范" 并写入文件。
    *   `[ ]` 2.14: 转换章节 "14. 规划蓝图规范" 并写入文件。
    *   `[ ]` 2.15: 转换章节 "15. 项目长期记忆规范..." 并写入文件。
*   `[ ]` **里程碑3: 最终验证与交付**
    *   `[ ]` 3.1: **(验证点)** 读取完整的 `PROMPT_MEMORY.json` 文件。
    *   `[ ]` 3.2: 在本地或使用在线工具验证其JSON语法的正确性。
    *   `[ ]` 3.3: 创建任务完成报告。

## 5. 风险评估与应对策略 (Risk Assessment & Mitigation Plan)

*   **风险1**: 单次写入的JSON内容过大或包含特殊字符，导致 `edit_file` 失败或生成无效JSON。
    *   **应对**: 严格执行分段写入策略，每次只写入一个章节的JSON。在每次写入后，理论上可以增加一次读取和语法验证，但为了效率，计划在所有分段写入完成后进行最终的完整验证。
*   **风险2**: 手动转换Markdown到JSON时出现遗漏或结构错误。
    *   **应对**: 在转换每个章节时，仔细对照原始Markdown文件。最终的验证环节将是捕获这类问题的最后防线。

